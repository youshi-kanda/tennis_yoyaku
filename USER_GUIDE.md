# テニスコート自動予約システム - ユーザーガイド

## 📖 目次
1. [はじめに](#はじめに)
2. [初期設定](#初期設定)
3. [監視設定](#監視設定)
4. [予約上限設定](#予約上限設定)
5. [履歴確認](#履歴確認)
6. [トラブルシューティング](#トラブルシューティング)

---

## はじめに

このシステムは、品川区・港区のテニスコート予約を自動化するPWA（Progressive Web App）です。

### 主な機能
- 🔍 **自動監視**: 選択した施設・時間帯を5分ごとに自動チェック
- 🎯 **自動予約**: 空きが見つかったら即座に予約
- 📱 **プッシュ通知**: 空き検出・予約成功を即座にお知らせ
- ⚙️ **柔軟な設定**: 期間・時間帯・施設を自由にカスタマイズ

### アクセス方法
PWA URL: https://pwa-pzltv277c-kys-projects-ed1892e5.vercel.app

---

## 初期設定

### 1. アカウント登録

1. PWAのURLにアクセス
2. 「新規登録」ボタンをクリック
3. メールアドレスとパスワードを入力
4. 「登録」ボタンをクリック

**推奨**:
- メールアドレス: よく使うもの
- パスワード: 8文字以上、英数字混在

### 2. 認証情報の保存

監視を開始する前に、各自治体の予約サイトのログイン情報を保存する必要があります。

#### 品川区の設定
1. ダッシュボードで「設定」タブをクリック
2. 「品川区予約サイト ログイン情報」セクションを見つける
3. 利用者番号とパスワードを入力
4. 「保存」ボタンをクリック

#### 港区の設定
1. 「港区予約サイト ログイン情報」セクションを見つける
2. 利用者番号とパスワードを入力
3. 「保存」ボタンをクリック

**セキュリティ**: 
- 情報は暗号化されてCloudflare KVに保存されます
- 第三者に共有されることはありません

### 3. プッシュ通知の許可

1. 「設定」タブの「通知設定」セクション
2. 「プッシュ通知」をONに切り替え
3. ブラウザの許可ダイアログで「許可」をクリック

---

## 監視設定

### 基本的な流れ

1. **ダッシュボードで「自動監視・予約」タブを開く**

2. **監視する施設を選択**
   - 品川区・港区の施設リストが表示されます
   - チェックボックスで監視したい施設を選択
   - 「全選択」ボタンで一括選択も可能

3. **監視期間を設定**
   - **単一日付**: 特定の1日のみ監視
   - **期間指定**: 開始日〜終了日の範囲を監視
   - **継続監視**: 翌日から1年先まで自動監視（推奨）

4. **監視する時間帯を選択**
   - チェックボックスで希望の時間帯を選択
   - プリセットボタンで素早く選択:
     - 「朝（9-13時）」
     - 「昼（13-17時）」
     - 「夕方〜夜（17-21時）」
     - 「全て選択」

5. **優先度を設定**
   - スライダーで1-5の優先度レベルを設定
   - 5（最優先）: 絶対に取りたい予約
   - 3（普通）: 通常の予約
   - 1（低優先度）: 空いていれば取りたい

6. **予約戦略を選択**
   - **優先順位予約**: 1枠ずつ確実に予約（推奨）
   - **全件予約**: 空いている枠をすべて予約

7. **「全施設の監視を開始」ボタンをクリック**

---

### 監視設定の例

#### 例1: 平日夕方のみ監視
```
施設: しながわ中央公園コートA, B
期間: 継続監視
時間帯: 17:00-19:00, 19:00-21:00（夕方プリセット）
優先度: 4（やや高）
```

#### 例2: 週末の朝を確実に予約
```
施設: 港区 有栖川宮記念公園コート
期間: 期間指定（2025-03-01 〜 2025-03-31）
時間帯: 09:00-11:00, 11:00-13:00（朝プリセット）
優先度: 5（最優先）
```

#### 例3: 複数施設を広く監視
```
施設: 品川区全施設（全選択）
期間: 継続監視
時間帯: 全時間帯（全選択）
優先度: 3（普通）
```

---

## 予約上限設定

予約しすぎを防ぐために、週・月の予約回数に上限を設定できます。

### 設定方法

1. 「設定」タブを開く
2. 「予約上限設定」セクションを見つける
3. 週あたり・月あたりの上限を入力
   - 例: 週2回まで → 「2」と入力
   - 例: 月8回まで → 「8」と入力
   - 制限なし → 「0」と入力
4. 「予約上限を保存」ボタンをクリック

### 動作
- 上限に達した場合、監視は継続しますが予約は自動スキップ
- 通知は引き続き受け取れます
- 「予約をスキップしました」というメッセージが表示されます

---

## 履歴確認

### 予約履歴
「履歴」タブで過去の予約を確認できます。

表示内容:
- ✅ 予約成功: 緑色で表示
- ❌ 予約失敗: 赤色で表示
- 施設名、日付、時間帯
- 予約日時

### 監視状況
「自動監視・予約」タブで現在の監視状態を確認できます。

表示内容:
- 監視中の施設数
- 開始時刻
- 予約戦略

---

## トラブルシューティング

### Q: 監視を開始できない

**A1: 認証情報が未設定**
- 「設定」タブで利用者番号・パスワードを保存してください
- エラーメッセージ: 「認証情報が未設定です」

**A2: 施設・時間帯が未選択**
- 最低1つの施設と1つの時間帯を選択してください

### Q: 予約が成功しない

**A1: 認証情報が間違っている**
- 「設定」タブで正しい利用者番号・パスワードを再入力

**A2: 予約上限に達している**
- 「設定」タブで予約上限を確認
- 上限を増やすか、0（制限なし）に設定

**A3: 空き枠が競争率高い**
- 優先度を5（最優先）に上げる
- 監視する施設を増やす
- 時間帯を広げる

### Q: 通知が来ない

**A1: プッシュ通知が無効**
- 「設定」タブで「プッシュ通知」をONに

**A2: ブラウザの通知が許可されていない**
- ブラウザの設定で通知を許可

**A3: PWAがバックグラウンドで動作していない**
- PWAをホーム画面に追加（推奨）
- ブラウザを開きっぱなしにする

### Q: 監視を停止したい

**A**: 「自動監視・予約」タブで「監視を停止」ボタンをクリック

### Q: 特定の施設だけ監視から外したい

**A**: 
1. 一度「監視を停止」
2. 施設を選び直す
3. 再度「監視を開始」

---

## ヒント・Tips

### 🎯 効率的な監視設定

1. **継続監視を活用**
   - 毎回設定し直す手間が省ける
   - 長期間の予約チャンスを逃さない

2. **優先度を使い分け**
   - 絶対に取りたい日: 優先度5
   - 空いていれば: 優先度1-2

3. **予約上限で過剰予約を防止**
   - 例: 週2回までに設定
   - 取りすぎを防ぎ、キャンセルの手間を削減

4. **プリセットで素早く設定**
   - 「夕方〜夜」プリセットで平日対応
   - 「全て選択」で週末対応

### 📱 PWAをホーム画面に追加

iPhoneの場合:
1. SafariでPWAを開く
2. 共有ボタン → 「ホーム画面に追加」
3. アイコンをタップしてアプリのように使用

Androidの場合:
1. ChromeでPWAを開く
2. メニュー → 「ホーム画面に追加」
3. アイコンをタップしてアプリのように使用

---

## サポート

### 問題が解決しない場合

1. ブラウザのキャッシュをクリア
2. ログアウト→再ログイン
3. 別のブラウザで試す

### フィードバック・要望

GitHubリポジトリ: https://github.com/youshi-kanda/tennis_yoyaku

---

**最終更新**: 2025年11月23日  
**バージョン**: 2.0.0
