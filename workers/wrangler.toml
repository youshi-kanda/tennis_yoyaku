name = "tennis-yoyaku-api"
main = "src/index.ts"
compatibility_date = "2024-12-13"
compatibility_flags = ["nodejs_compat_v2"]

# ===== Production Environment =====
# KV Namespaces (Production)
[[kv_namespaces]]
binding = "USERS"
id = "2bb51589e95d448abc4f6821a5898865"

[[kv_namespaces]]
binding = "SESSIONS"
id = "2111997ed58e4f5080074fc0a95cacf0"

[[kv_namespaces]]
binding = "MONITORING"
id = "5a8f67abf49546b58f6113e18a5b2443"

[[kv_namespaces]]
binding = "RESERVATIONS"
id = "6e26433ee30b4ad0bc0a8749a67038be"

# Durable Objects (Production)
[[durable_objects.bindings]]
name = "USER_AGENT"
class_name = "UserAgent"

[[migrations]]
tag = "v1"
new_classes = ["UserAgent"]



# Queues (Producer)
[[queues.producers]]
queue = "tennis-reservation-queue"
binding = "RESERVATION_QUEUE"

# Queues (Consumer)
[[queues.consumers]]
queue = "tennis-reservation-queue"
max_batch_size = 5
max_batch_timeout = 30

# Environment variables (Production)
[vars]
ENVIRONMENT = "production"
# Secrets should be set via `wrangler secret put`
# JWT_SECRET
# ADMIN_KEY
# VAPID_PUBLIC_KEY
# VAPID_PRIVATE_KEY
VAPID_SUBJECT = "mailto:youshi.kanda@gmail.com"
MAINTENANCE_MODE = "false"  # メンテナンスモード: true=有効, false=無効
MAINTENANCE_MESSAGE = "システムメンテナンス中です。しばらくお待ちください。"

# Explicitly disable Cron Triggers to remove legacy configurations
[triggers]
crons = []

# ===== Development Environment =====
[env.development]
name = "tennis-yoyaku-api-dev"

# KV Namespaces (Development)
[[env.development.kv_namespaces]]
binding = "USERS"
id = "c0d3c217a6544bcabe55d2a489d35158"

[[env.development.kv_namespaces]]
binding = "SESSIONS"
id = "940200cc91dc45af854bde2ff274ea94"

[[env.development.kv_namespaces]]
binding = "MONITORING"
id = "29eca291199b4570a451fe20775f11ee"

[[env.development.kv_namespaces]]
binding = "RESERVATIONS"
id = "272a3a9914bd407e9389ca2d8ef907db"



# Environment variables (Development)
[env.development.vars]
ENVIRONMENT = "development"
JWT_SECRET = "dev-jwt-secret-for-testing-only"
ADMIN_KEY = "tennis_admin_2025"
VAPID_PUBLIC_KEY = "BJl4G42CTnBBIz0YBhm2yZSPEgyNjXjBnjEXZwT1g0hCiHIGYesl8ePExqj9zcl7kBqRqug9rvg9qLTEtC1KjyQ"
VAPID_PRIVATE_KEY = "M3GGZhN2hN2Df1GlKD8cLBQGqU3JBdVW4whF7hb_aTI"
VAPID_SUBJECT = "mailto:youshi.kanda+dev@gmail.com"
MAINTENANCE_MODE = "false"
MAINTENANCE_MESSAGE = "システムメンテナンス中です。しばらくお待ちください。"

# Durable Objects (Development)
[[env.development.durable_objects.bindings]]
name = "USER_AGENT"
class_name = "UserAgent"

[[env.development.migrations]]
tag = "v1"
new_classes = ["UserAgent"]
